<section class="">
  <h1>Leaderboard</h1>
  <%= form_with url: "/leaderboard", method: :get, data: { controller: "actions", turbo_frame: 'leaderboard-frame' } do |form| %>
    <%= form.select :division, options_for_select(["Scaled Femenino", "Scaled Masculino", "Intermedio Femenino", "Intermedio Masculino", "RX Masculino"], "Scaled Femenino"), {}, data: { action: 'change->actions#submit' } %>
  <% end %>
  <turbo-frame id="leaderboard-frame" target="_top">
    <% @athletes.each do |athlete| %>
      <div class="flex flex-col md:flex-row md:hidden border-t-2 border-gray-300">
        <div data-controller="leaderboard" data-action="click->leaderboard#toggle" id="athlete_<%= athlete.id %>" class="gap-4 px-4 h-16 items-center cursor-pointer flex justify-between"> 
          <p class="text-sm leading-none font-semibold"><%= athlete.rank %></p>
          <p class="uppercase flex-1 text-sm leading-none font-semibold"><%= athlete.full_name %></p>

          <p class="text-sm leading-none font-semibold"><%= athlete.total_points %></p>
            <span data-leaderboard-target="iconDown">
          <i class="fa-solid fa-chevron-down"></i>
          </span>
          <span class="hidden" data-leaderboard-target="iconUp">
            <i class="fa-solid fa-chevron-up"></i>
          </span>

        </div>
        <div id="athlete_<%= athlete.id %>_details" class="max-h-0 overflow-hidden transition-all ease-in-out duration-300 flex flex-col px-10">
          <% athlete.scores.each do |score| %>
            <p class="text-sm leading-loose">
              <%= score.workout.name %>: <%= format_rank(score.rank) %> (<%= format_score(score.main_score, score.workout_type) %>) <%= score.points %>pts
            </p>
          <% end %>
        </div>
      </div>
    <% end %>
  </turbo-frame>
</section>
